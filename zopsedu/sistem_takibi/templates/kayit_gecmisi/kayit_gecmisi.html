{% extends "base.html" %}
{% from "macros/form_helpers/select_fields.html" import render_select_field_without_label %}
{% from "macros/form_helpers/text_fields.html" import render_text_field_without_label %}


{% block context %}

    <div class="content-header row">
        <div class="content-header-left col-md-8 col-12 mb-2 breadcrumb-new">
            <h3 class="content-header-title mb-0 d-inline-block"> {{ _("Kullanıcı Aktivite Listesi") }} </h3>
        </div>
    </div>
    <div class="content-body">
        <section class="card">
            <div class="card-content">
                <div class="card-body">
                    <form method="post" class="form">
                        {{ form.csrf_token }}
                        {#                                <div class="row form-group">#}
                        {#                                    <div class="col-md-6">#}
                        {#                                        {{ form.activite_tipleri.label }}#}
                        {#                                        {{ render_select_field_without_label(form.activite_tipleri) }}#}
                        {#                                    </div>#}
                        {#                                    <div class="col-md-6">#}
                        {#                                        {{ form.username.label }}#}
                        {#                                        {{ render_text_field_without_label(form.username) }}#}
                        {#                                    </div>#}
                        {#                                </div>#}
                        {#                                <div class="row mt-3 form-group">#}
                        {#                                    <div class="col-md-6">#}
                        {#                                        {{ form.tarih_arama.baslama_tarihi.label }}#}
                        {#                                        <div class="row">#}
                        {#                                            <div class="col-md-8">#}
                        {#                                                {{ form.tarih_arama.baslama_tarihi }}#}
                        {##}
                        {#                                            </div>#}
                        {#                                            <div class="col-md-4">#}
                        {#                                                {{ form.tarih_arama.baslama_tarihi_option(class="form-control") }}#}
                        {##}
                        {#                                            </div>#}
                        {#                                        </div>#}
                        {#                                    </div>#}
                        {#                                    <div class="col-md-6">#}
                        {#                                        {{ form.tarih_arama.bitis_tarihi.label }}#}
                        {#                                        <div class="row">#}
                        {#                                            <div class="col-md-8">#}
                        {#                                                {{ form.tarih_arama.bitis_tarihi }}#}
                        {##}
                        {#                                            </div>#}
                        {#                                            <div class="col-md-4">#}
                        {#                                                {{ form.tarih_arama.bitis_tarihi_option(class="form-control") }}#}
                        {##}
                        {#                                            </div>#}
                        {#                                        </div>#}
                        {#                                    </div>#}
                        {#                                </div>#}
                        {#                                <div class="row form-group">#}
                        {#                                    <div class="col-md-6">#}
                        {#                                        {{ form.ara_text.label }}#}
                        {#                                        {{ render_text_field_without_label(form.ara_text) }}#}
                        {#                                    </div>#}
                        {#                                </div>#}
                        <div class="form-group row">
                            <div class="col-md-3">
                                {{ form.username.label }}
                            </div>

                            <div class="col-md-3">
                                {{ render_text_field_without_label(form.username) }}
                            </div>
                        </div>
                        <div class="form-group row">
                            <div class="col-md-3">
                                {{ form.activite_tipleri.label }}
                            </div>

                            <div class="col-md-3">
                                {{ render_select_field_without_label(form.activite_tipleri) }}
                            </div>
                        </div>
                       <div class="form-group row">
                            <div class="col-md-3">
                                {{ form.ara_text.label }}
                            </div>

                            <div class="col-md-3">
                                {{ form.ara_text(class='height-30 width-full') }}
                            </div>
                        </div>
                        <div>
                           <div class="form-group row">
                                <div class="col-md-3">
                                    {{ form.tarih_arama.baslama_tarihi.label }}
                                </div>

                                <div class="col-md-3">
                                    {{ form.tarih_arama.baslama_tarihi }}
                                </div>
                                <div class="col-md-2">
                                    <div class="form-group">
                                        {{ form.tarih_arama.baslama_tarihi_option(class="form-control") }}
                                    </div>

                                </div>
                            </div>
                            <div class="form-group row">
                                <div class="col-md-3">
                                    {{ form.tarih_arama.bitis_tarihi.label }}
                                </div>

                                <div class="col-md-3">
                                    {{ form.tarih_arama.bitis_tarihi }}
                                </div>
                                <div class="col-md-2">
                                    {{ form.tarih_arama.bitis_tarihi_option(class="form-control") }}
                                </div>
                            </div>
                        </div>
                        {{ form.ara(class="btn btn-search btn-success m-r") }}
                        {{ form.temizle(class="btn btn-clear btn-warning") }}
                    </form>
                    <div class="row">
                        <div id="data-table_wrapper"
                             class="dataTables_wrapper form-inline dt-bootstrap no-footer">
                            <table id="data-table"
                                   class="table table-striped table-bordered dataTable no-footer dtr-inline"
                                   role="grid"
                                   aria-describedby="data-table_info">
                                <thead>
                                <tr role="row">
                                    <th width="5%">{{ _("#") }}</th>
                                    <th class="all sorting_asc" tabindex="0"
                                        aria-controls="data-table"
                                        rowspan="1"
                                        colspan="1" aria-sort="ascending"
                                        aria-label="Rendering engine: activate to sort column descending"
                                        style="width: 180px;">{{ _("İşlem  Tarihi") }}
                                    </th>
                                    <th class="sorting_asc" tabindex="0"
                                        aria-controls="data-table" rowspan="1"
                                        colspan="1" aria-sort="ascending"
                                        aria-label="Rendering engine: activate to sort column descending"
                                        style="width: 180px;">{{ _("İşlemi Yapan") }}
                                    </th>
                                    <th class="sorting_asc" tabindex="0"
                                        aria-controls="data-table" rowspan="1"
                                        colspan="1" aria-sort="ascending"
                                        aria-label="Rendering engine: activate to sort column descending"
                                        style="width: 180px;">{{ _("İşlem Açıklaması") }}
                                    </th>
                                    <th class="sorting_asc" tabindex="0"
                                        aria-controls="data-table" rowspan="1"
                                        colspan="1" aria-sort="ascending"
                                        aria-label="Rendering engine: activate to sort column descending"
                                        style="width: 180px;">{{ _("Ip") }}
                                    </th>
                                    <th class="all sorting_asc" tabindex="0"
                                        aria-controls="data-table" rowspan="1"
                                        colspan="1" aria-sort="ascending"
                                        aria-label="Rendering engine: activate to sort column descending"
                                        style="width: 180px;">{{ _("Detay") }}
                                    </th>
                                </tr>
                                </thead>
                                <tbody>

                                {% if not activities %}
                                    <tr>
                                        <td colspan="6">{{ _("Gösterilecek eleman bulunmamaktadır.") }}</td>
                                    </tr>
                                {% endif %}

                                {% for activity in activities %}
                                    {#                                    0 - islem tarihi,#}
                                    {#                                    1 - mesaj ,#}
                                    {#                                    2 - ip ,#}
                                    {#                                    3 - ad,#}
                                    {#                                    4 - soyad #}
                                    {#                                    5 - unvan #}
                                    {#                                    6 - context #}
                                    {% set color = loop.cycle("#f2f3f4", "#ffffff") %}
                                    <tr role="row" class="odd">
                                        <td style="background-color: {{ color }}"
                                            rowspan="1">{{ loop.index }}</td>
                                        <td style="background-color: {{ color }}"
                                            class="sorting_1"
                                            tabindex="0">{{ activity.activity_time.strftime("%d-%m-%Y %H:%M:%S") }}</td>
                                        <td style="background-color: {{ color }}"
                                            class="sorting_1"
                                            tabindex="0">{{ "{role_name} {ad} {soyad}".format(role_name=activity.role_name, ad=activity.person_ad, soyad=activity.person_soyad) }}</td>
                                        <td style="background-color: {{ color }}"
                                            class="sorting_1"
                                            tabindex="0">{{ activity.activity_extra_mesaj }}</td>
                                        <td style="background-color: {{ color }}"
                                            class="sorting_1"
                                            tabindex="0">{{ activity.activity_remote_ip }}</td>
                                        <td><a class="detail_arrow"
                                                {# todo proje button urli düzeltilecek #}
                                               href="{{ url_for('.detay', activity_id=activity.activity_id) }}"><span
                                                class="fa fa-arrow-circle-right fa-2x "></span></a>
                                        </td>
                                    </tr>

                                {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

{% endblock %}